<div class="component" #project>

    <div class="project" [ngClass]="projectOpen ? 'rounded-s-xl' : 'rounded-xl'" >
        <div class="project-image">
            <div class="image">
                <img *ngIf="!verifyImgproject() && preImage" [src]="preImage" alt="">
                <img *ngIf="!verifyImgproject() && !preImage && projeto.image" [src]="projeto.image.data" alt="">
            </div>
            <label [ngClass]="!projeto.editOn ? 'invisible':'visible'" class=" border-primary dark:border-secondary bottom-3 right-10 rounded-full p-2 bg-white dark:bg-back-grey w-12 h-12 absolute cursor-pointer">
                <div class="flex items-center justify-center w-full h-full">
                    <i class="pi pi-camera cursor-pointer"></i>
                </div>
                <input
                    [disabled]="!projeto.editOn"
                    class="invisible w-full  cursor-pointer h-full absolute top-0 left-0"
                    (change)="setImageProject($event)"
                    type="file"
                />
            </label>
        </div>
        <div class="project-name"><input [disabled]="!projeto.editOn" type="text" [(ngModel)]="projeto.name"></div>
        <div class="project-desc"><textarea [disabled]="!projeto.editOn" name="" id="" cols="30" rows="10" [(ngModel)]="projeto.description"></textarea></div>
        <div class="project-user-response">
            <p>Criador:</p>
            <div *ngIf="verifyImg(projeto.creator) && projeto.creator" [ngStyle]="{'background': projeto.creator.imageColor }" >{{projeto.creator.name.charAt(0).toUpperCase()}}</div>
            <div class="overflow-hidden object-center" *ngIf="!verifyImg(projeto.creator)">
                <img class="fotoImagem" class="" *ngIf="!verifyImg(projeto.creator)" src="{{projeto.creator.image.data}}" alt="">
            </div>
        </div>
        <div class="project-progress"><div></div></div>
        <div class="project-final-date"><p>data final: 
            <input #data [disabled]="!projeto.editOn" type="date" [(ngModel)]="projeto.finalDate" class="bg-transparent">
        </p></div>
    </div>
    <div class="project-open" [ngClass]="!projectOpen ? 'w-0':'w-[25vw] px-[2%] rounded-r-xl'" (click)="openAgain()">
        <div class="project-open-infos">
            <div class="tittle-infos">
                <p>Nome</p>
                <p>Progresso</p>
                <p>Status</p>
                <p>Prazo</p>
            </div>
            
            <div class="value-infos">
                <div [ngClass]="getTasksLength() === 0 ? 'invisible':'visible'" class="values" *ngFor="let t of projeto.tasks">
                    <p class="Nome">{{t.name}}</p>
                    <div class="Progresso">
                        <div class="valor-progresso"  [style.width.%]="t.conclusionPercentage" ></div>
                    </div>
                    <p class="Status" [style.backgroundColor]="t.currentStatus.backgroundColor" >{{t.currentStatus.name}}</p>
                    <p class="Prazo">{{t.finalDate}}</p>
                </div>
                <div *ngIf="getTasksLength() === 0" class="h-[80%] w-full flex justify-center items-center text-xl text-fontGray whitespace-nowrap">
                    <p>Nenhuma tarefa criada</p>
                </div>
            </div>
        </div>
        <div class="project-open-users">
            <span><</span>
            <div class="users">
                <div class="users-spam" *ngFor="let p of projeto.members">
                    <div *ngIf="verifyImg(p) && !p.image" class="user-image-chartAt" [ngStyle]="{'background': p.imageColor }" >{{p.name.charAt(0).toUpperCase()}}</div>
                    <div *ngIf="!verifyImg(p)" class="user-image-chartAt overflow-hidden object-center">
                        <img class="fotoImagem" class="" *ngIf="!verifyImg(p)" src="{{p.image.data}}" alt="">
                    </div>
                    <p>{{p.name}}</p>
                </div>
            </div>
            <span>></span>
        </div>

        <div class="botoes">
            <button *ngIf="!projeto.editOn" class="botao-cancelar" (click)="deletarProjeto(projeto.id)" >Deletar Projeto <i class="pi pi-trash"></i></button>
            <button *ngIf="projeto.editOn" class="botao-cancelar" (click)="cancelEdit()" >Cancelar Edição <i class="pi pi-times"></i></button>
            <button *ngIf="!projeto.editOn" class="botao-editar-projeto" (click)="editProjectEmit(true)">Editar Projeto <i class="pi pi-pencil"></i> </button>
            <button *ngIf="projeto.editOn" class="botao-salvar-projeto" (click)="salvaProjeto()">Salvar Edição <i class="pi pi-save"></i> </button>
            <button [disabled]="projeto.editOn" [ngClass]="projeto.editOn ? 'opacity-50 cursor-not-allowed':'hover:scale-105'" class="botao-ir-para-tarefa" (click)="irParaProjeto()">Ir para tarefas <i class="pi pi-angle-double-right"></i></button>
        </div>
    </div>
</div>

